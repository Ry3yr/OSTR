
<style>
#game-container{position:relative}.window-wrapper-outer{border:1px solid;border-color:#f1efe2 #716f64 #716f64 #f1efe2}.window-wrapper-inner{border:1px solid;border-color:#fff #aca899 #aca899 #fff}.window-container{position:relative;background-color:#ece9d8;padding:1px}#custom-level-dialog{display:none;position:absolute;top:30px;left:15px;z-index:3;width:200px}.title-bar{height:25px;background:#3d95ff url(https://raw.githubusercontent.com/joelbyrd/external-resources/master/images/minesweeper.png) no-repeat;font-size:0;line-height:0}#custom-title-bar{background-position:0 -110px}#custom-dialog-content{overflow:hidden;font:12px arial;padding:35px 15px}#minesweeper-custom-fields{float:left}#minesweeper-custom-fields p{clear:left;margin:0;padding:0;margin-bottom:4px}#high-score-dialog label,#minesweeper-custom-fields label{float:left;width:47px;padding-top:3px}.form-textbox{width:35px;height:14px;border:2px solid;border-color:#aca899 #fff #fff #aca899}#minesweeper-custom-buttons{float:right}.form-button{display:block;width:60px;height:25px;background:#ece9d8}#minesweeper-ok-btn{margin-bottom:18px}#high-score-dialog{display:none;position:absolute;top:10px;left:15px;z-index:4;width:200px}#high-score-dialog-content{overflow:hidden;font:12px arial;padding:10px}#high-score-dialog h2{font-size:14px;font-weight:700;text-transform:uppercase;text-align:center}#high-score-dialog #high-score-name-label{width:40px}#high-score-name-textbox{width:120px}#submit-high-score-container{text-align:center}#submit-high-score{width:auto}#minesweeper-board-wrapper{position:relative;background-color:#bdbdbd;padding:7px;border-left:3px solid #fff;border-top:3px solid #fff}#minesweeper-title-bar{background-position:0 -84px}#menu-link-container{overflow:hidden;padding-top:1px}#menu-link{float:left;padding:3px 6px;color:#000;text-decoration:none;cursor:default;font:12px arial}#menu-link.active,#menu-link:hover{color:#fff;background:#316ac5}#menu{display:none;position:absolute;top:-4px;left:-3px;z-index:2;list-style:none;width:122px;margin:0;padding:2px;background:#fff;border:1px solid #aca899;font:12px arial}#menu li{display:block;margin:0;padding:4px 5px 4px 16px;color:#000;text-decoration:none;cursor:default}#menu li:hover{color:#fff;background-color:#316ac5}#menu li.checked{background-image:url(https://raw.githubusercontent.com/joelbyrd/external-resources/master/images/minesweeper.png);background-repeat:no-repeat;background-position:-136px -41px}#menu li.checked:hover{background-position:-134px -69px}#menu li.menu-divider{font-size:0;line-height:0;height:0;border-bottom:1px solid #aca899;margin:5px 1px;padding:0}#minesweeper-header-container{padding:3px 5px;border:2px solid;border-color:#7d7d7d #fff #fff #7d7d7d}#minesweeper-header-wrapper{border-bottom:7px solid #bdbdbd}#minesweeper-header{position:relative;overflow:hidden}#minefield{overflow:hidden;border:3px solid;border-color:#7d7d7d #fff #fff #7d7d7d}#minefield div{float:left;width:16px;height:16px;background:url(https://raw.githubusercontent.com/joelbyrd/external-resources/master/images/minesweeper.png) no-repeat}#minefield .covered{background-position:0 -39px}#minefield .mines0{background-position:0 -23px}#minefield .mines1{background-position:-16px -23px}#minefield .mines2{background-position:-32px -23px}#minefield .mines3{background-position:-48px -23px}#minefield .mines4{background-position:-64px -23px}#minefield .mines5{background-position:-80px -23px}#minefield .mines6{background-position:-96px -23px}#minefield .mines7{background-position:-112px -23px}#minefield .mines8{background-position:-128px -23px}#minefield .mine-hit{background-position:-32px -39px}#minefield .mine-misflagged{background-position:-48px -39px}#minefield .mine{background-position:-64px -39px}#minefield .flag{background-position:-16px -39px}#minefield .question{background-position:-80px -39px}#mine-count,#timer{overflow:hidden;position:absolute;top:1px;z-index:1;border:1px solid;border-color:grey #fff #fff grey}#mine-count{left:0}#timer{right:0}.numbers div{float:left;width:13px;height:23px;background:url(https://raw.githubusercontent.com/joelbyrd/external-resources/master/images/minesweeper.png) no-repeat}#minesweeper-reset-button{background:url(https://raw.githubusercontent.com/joelbyrd/external-resources/master/images/minesweeper.png) no-repeat;height:26px;width:26px;margin:0 auto}#minesweeper-reset-button.face-smile{background-position:0 -55px}#minesweeper-reset-button.face-pressed{background-position:-26px -55px}#minesweeper-reset-button.face-surprised{background-position:-52px -55px}#minesweeper-reset-button.face-sad{background-position:-78px -55px}#minesweeper-reset-button.face-sunglasses{background-position:-104px -55px}.numbers .t0{background-position:0 0}.numbers .t1{background-position:-13px 0}.numbers .t2{background-position:-26px 0}.numbers .t3{background-position:-39px 0}.numbers .t4{background-position:-52px 0}.numbers .t5{background-position:-65px 0}.numbers .t6{background-position:-78px 0}.numbers .t7{background-position:-91px 0}.numbers .t8{background-position:-104px 0}.numbers .t9{background-position:-117px 0}.numbers .tm{background-position:-130px 0}
</style>
</head>
<body>
<!-- partial:index.partial.html -->
<div id="game"><!-- minesweeper game initializes here --></div>
<!-- partial -->
  <script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js'>
  </script><script>var minesweeper={cellWidth:16,levels:{beginner:{id:1,rows:9,cols:9,mines:10},intermediate:{id:2,rows:16,cols:16,mines:40},expert:{id:3,rows:16,cols:30,mines:99}},minCustomRows:1,minCustomCols:7,maxCustomRows:50,maxCustomCols:50,defaultLevel:"beginner",currentLevel:null,numRows:null,numCols:null,numMines:null,mineCount:null,numCells:null,numRowsActual:null,numColsActual:null,target:null,cells:[],safeCells:[],mineCells:[],flagStates:["covered","flag","question"],numFlagStates:null,includeMarks:!0,madeFirstClick:!1,stopTimerID:0,timer:0,gameInProgress:!1,won:!1,mouseDown:!1,gameInitialized:!1,customDialogOpen:!1,$windowWrapperOuter:null,$resetButton:null,$mineCountOnes:null,$mineCountTens:null,$mineCountHundreds:null,$timerOnes:null,$timerTens:null,$timerHundreds:null,$minefield:null,init:function(e){var i=this;this.target=e?"#"+e:"body",this.numFlagStates=i.flagStates.length,$(this.target).append('<div id="game-container"><div id="custom-level-dialog" class="window-wrapper-outer"><div class="window-wrapper-inner"><div class="window-container"><div id="custom-title-bar" class="title-bar"></div><div id="custom-dialog-content"><div id="minesweeper-custom-fields"><p><label>Height:</label><input type="text" id="minesweeper-custom-height" class="form-textbox"></p><p><label>Width:</label><input type="text" id="minesweeper-custom-width" class="form-textbox"></p><p><label>Mines:</label><input type="text" id="minesweeper-custom-mines" class="form-textbox"></p></div><div id="minesweeper-custom-buttons"><input type="button" value="OK" id="minesweeper-ok-btn" class="form-button" /><input type="button" value="Cancel" id="minesweeper-cancel-btn" class="form-button" /></div></div></div></div></div><div id="high-score-dialog" class="window-wrapper-outer"><div class="window-wrapper-inner"><div class="window-container"><div id="high-score-dialog-content"><h2>High score!</h2></p><p><label id="high-score-name-label">Name:</label><input type="text" id="high-score-name-textbox" class="form-textbox" maxlength="20" /></p><p id="submit-high-score-container"><input type="button" value="Submit High Score" id="submit-high-score" class="form-button" /></p></div></div></div></div><div id="window-wrapper-outer" class="window-wrapper-outer"><div class="window-wrapper-inner"><div class="window-container"><div id="minesweeper-title-bar" class="title-bar"></div><div id="menu-link-container"><a id="menu-link" href="#">Game</a></div><div id="minesweeper-board-wrapper"><ul id="menu"><li id="menu-new">New</li><li class="menu-divider"></li><li id="menu-beginner" class="game-level checked">Beginner</li><li id="menu-intermediate" class="game-level">Intermediate</li><li id="menu-expert" class="game-level">Expert</li><li id="menu-custom" class="game-level">Customâ€¦</li><li class="menu-divider"></li><li id="menu-marks" class="checked">Marks (?)</li></ul><div id="minesweeper-header-wrapper"><div id="minesweeper-header-container"><div id="minesweeper-header"><div id="mine-count" class="numbers"><div id="mine-count-hundreds" class="t0"></div><div id="mine-count-tens" class="t1"></div><div id="mine-count-ones" class="t0"></div></div><div id="minesweeper-reset-button" class="face-smile"></div><div id="timer" class="numbers"><div id="timer-hundreds" class="t0"></div><div id="timer-tens" class="t0"></div><div id="timer-ones" class="t0"></div></div></div></div></div><div id="minefield"></div></div></div></div></div></div>'),this.$windowWrapperOuter=$("#window-wrapper-outer"),this.$resetButton=$("#minesweeper-reset-button"),this.$mineCountOnes=$("#mine-count-ones"),this.$mineCountTens=$("#mine-count-tens"),this.$mineCountHundreds=$("#mine-count-hundreds"),this.$timerOnes=$("#timer-ones"),this.$timerTens=$("#timer-tens"),this.$timerHundreds=$("#timer-hundreds"),this.$minefield=$("#minefield");var s=$("#menu"),t=$("#menu-link"),n=$("#menu-new"),l=$("#menu-beginner"),o=$("#menu-intermediate"),a=$("#menu-expert"),r=$("#menu-custom"),u=$("#menu-marks"),m=$("#custom-level-dialog"),c=$("#minesweeper-custom-width"),d=$("#minesweeper-custom-height"),h=$("#minesweeper-custom-mines"),v=$("#minesweeper-ok-btn"),f=$("#minesweeper-cancel-btn");$(document.body).click(function(e){i.customDialogOpen||(s.hide(),t.removeClass("active"))}),s.add(t).add(m).bind("click",function(e){e.stopPropagation()}),t.bind("click",function(e){$(this).toggleClass("active"),s.toggle()}),n.bind("click",function(){i.reset(),s.hide(),t.removeClass("active")}),l.bind("click",function(){$(".game-level").removeClass("checked"),$(this).addClass("checked"),i.newGame("beginner"),s.hide(),t.removeClass("active")}),o.bind("click",function(){$(".game-level").removeClass("checked"),$(this).addClass("checked"),i.newGame("intermediate"),s.hide(),t.removeClass("active")}),a.bind("click",function(){$(".game-level").removeClass("checked"),$(this).addClass("checked"),i.newGame("expert"),s.hide(),t.removeClass("active")}),r.bind("click",function(){m.show(),i.customDialogOpen=!0}),u.bind("click",function(){$(this).toggleClass("checked"),i.toggleMarks(),s.hide(),t.removeClass("active")}),d.val(this.levels[this.defaultLevel].rows),c.val(this.levels[this.defaultLevel].cols),h.val(this.levels[this.defaultLevel].mines),$intChecks=c.add(d).add(h),$intChecks.bind("keyup",function(){/^\d+$/.test($(this).val())||$(this).val("")}),v.bind("click",function(){$(".game-level").removeClass("checked"),r.addClass("checked"),m.hide(),i.customDialogOpen=!1,s.hide(),t.removeClass("active");var e=+d.val(),n=+c.val(),l=+h.val(),o=e<i.minCustomRows?i.minCustomRows:e>i.maxCustomRows?i.maxCustomRows:e,a=n<i.minCustomCols?i.minCustomCols:n>i.maxCustomCols?i.maxCustomCols:e,u=Math.floor(o*a*2/3),v=l<1?1:l>u?u:l;v>999&&(v=999),d.val(o),c.val(a),h.val(v),i.newGame("custom",o,a,v)}),f.bind("click",function(){m.hide(),i.customDialogOpen=!1}),$("#submit-high-score").bind("click",function(){$(this).attr("disabled",!0),i.submitHighScore()}),this.$windowWrapperOuter.bind("contextmenu dragstart drag",function(){return!1}),this.$resetButton.bind("mousedown",function(e){if(this.mouseDown=!0,3===e.which)return!1;$(this).attr("class","face-pressed")}).bind("mouseup",function(e){if(this.mouseDown=!1,3===e.which)return!1;$(this).attr("class","face-smile")}).bind("mouseout",function(e){this.mouseDown&&$(this).attr("class","face-smile")}).bind("click",function(e){if(3===e.which)return!1;i.reset()}),this.newGame(this.defaultLevel),this.gameInitialized=!0},newGame:function(e,i,s,t,n){n=n||!1;if(this.gameInitialized&&this.stop(),n){var l,o,a;for(o=1;o<=this.numRows;o++)for(a=1;a<=this.numCols;a++)(l=this.cells[o][a]).$elem.attr("class","covered"),l.classUncovered="mines0",l.hasMine=!1,l.numSurroundingMines=0,l.flagStateIndex=0}else{if("custom"==e)this.numRows=i,this.numCols=s,this.numMines=t,this.mineCount=t;else{var r=this.levels[e];this.numRows=r.rows,this.numCols=r.cols,this.numMines=r.mines}for(this.numCells=this.numRows*this.numCols,this.numRowsActual=this.numRows+2,this.numColsActual=this.numCols+2,this.currentLevel=e,this.$windowWrapperOuter.css("width",this.cellWidth*this.numCols+27),this.cells=new Array(this.numRowsActual),o=0;o<this.numRowsActual;o++)this.cells[o]=new Array(this.numColsActual);for(this.$minefield.html(""),o=0;o<this.numRowsActual;o++)for(a=0;a<this.numColsActual;a++)o<1||o>this.numRows||a<1||a>this.numCols?$elem=null:($elem=$(document.createElement("div")).attr("class","covered"),this.$minefield.append($elem)),this.cells[o][a]={$elem:$elem,covered:!1,classUncovered:"mines0",hasMine:!1,numSurroundingMines:0,flagStateIndex:0}}this.setMineCount(this.numMines),this.setTimer(0),this.layMines(),this.calcMineCounts(),this.setClickEvents(),this.madeFirstClick=!1,this.$resetButton.attr("class","face-smile")},setClickEvents:function(){for(i=1;i<=this.numRows;i++)for(j=1;j<=this.numCols;j++){var e=this,s=e.cells[i][j];s.covered=!0,s.$elem.bind("mousedown",{_i:i,_j:j,_cell:s},function(i){e.mouseDown=!0;var s=i.data._cell;s.covered&&(3===i.which?(1==s.flagStateIndex&&e.setMineCount(e.mineCount+1),s.flagStateIndex=(s.flagStateIndex+1)%e.numFlagStates,1==s.flagStateIndex&&e.setMineCount(e.mineCount-1),s.$elem.attr("class",e.flagStates[s.flagStateIndex])):s.covered&&1!==s.flagStateIndex&&(e.$resetButton.attr("class","face-surprised"),s.$elem.attr("class","mines0")))}).bind("mouseover",{_cell:s},function(i){e.mouseDown&&i.data._cell.$elem.mousedown()}).bind("mouseout",{_cell:s},function(i){if(e.mouseDown){var s=i.data._cell;s.covered&&s.$elem.attr("class","covered")}}).bind("mouseup",{_i:i,_j:j,_cell:s},function(i){e.mouseDown=!1;var s=i.data,t=s._i,n=s._j,l=s._cell;e.$resetButton.attr("class","face-smile"),l.covered&&1!==l.flagStateIndex&&3!==i.which&&(e.madeFirstClick||(e.madeFirstClick=!0,e.start(),l.hasMine&&e.moveMine(t,n)),l.hasMine?(l.classUncovered="mine-hit",e.lose()):(e.revealCells(t,n),e.checkForWin()&&e.win()))})}},layMines:function(){var e,i,s;for(this.designateMineSpots(),s=0;s<this.numMines;s++)e=this.numToRowCol(this.mineCells[s]),(i=this.cells[e[0]][e[1]]).hasMine=!0,i.classUncovered="mine"},designateMineSpots:function(){var e,i;for(this.safeCells=[],this.mineCells=[],e=this.numCells;e--;)this.safeCells.push(e+1);for(e=this.numMines;e--;)i=-~(Math.random()*this.safeCells.length)-1,this.mineCells.push(this.safeCells[i]),this.safeCells.splice(i,1)},calcMineCount:function(e,i){var s,t,n=0,l=this.cells[e][i];for(s=e-1;s<=e+1;s++)for(t=i-1;t<=i+1;t++)s==e&&t==i||this.cells[s][t].hasMine&&n++;l.numSurroundingMines=n,l.hasMine||(l.classUncovered="mines"+n)},calcMineCounts:function(){for(var e=1;e<=this.numRows;e++)for(var i=1;i<=this.numCols;i++)this.calcMineCount(e,i)},changeMineCount:function(e,i,s){s=s||1;var t=this.cells[e][i];newMineCount=t.numSurroundingMines+s,t.numSurroundingMines=newMineCount,t.hasMine||(t.classUncovered="mines"+newMineCount)},changeSurroundingMineCounts:function(e,s,t){for(i=e-1;i<=e+1;i++)for(j=s-1;j<=s+1;j++)i==e&&j==s||this.changeMineCount(i,j,t)},moveMine:function(e,i){var s=this.cells[e][i],t=this.rowColToNum(e,i);s.hasMine=!1,s.classUncovered="mines"+s.numSurroundingMines,this.mineCells.splice($.inArray(t,this.mineCells),1),this.safeCells.push(t),this.changeSurroundingMineCounts(e,i,-1);var n=-~(Math.random()*this.safeCells.length)-1,l=this.safeCells[n],o=this.numToRowCol(l),a=this.cells[o[0]][o[1]];a.hasMine=!0,a.classUncovered="mine",this.safeCells.splice($.inArray(l,this.safeCells),1),this.mineCells.push(l),this.changeSurroundingMineCounts(o[0],o[1],1)},revealMines:function(e){var s,t;e=e||!1;for(i,j,i=0;i<this.numMines;i++)t=this.numToRowCol(this.mineCells[i]),s=this.cells[t[0]][t[1]],e?1!==s.flagStateIndex&&(s.flagStateIndex=1,s.$elem.attr("class","flag")):1!==s.flagStateIndex||s.hasMine?s.hasMine&&s.$elem.attr("class",s.classUncovered):s.$elem.attr("class","mine-misflagged")},flagMines:function(){this.revealMines(!0)},revealCells:function(e,i){var s,t,n=this.cells[e][i];if(n.$elem.attr("class",n.classUncovered),n.covered=!1,!(n.numSurroundingMines>0))for(s=e-1;s<=e+1;s++)for(t=i-1;t<=i+1;t++)s==e&&t==i||this.cells[s][t].covered&&this.revealCells(s,t)},toggleMarks:function(){this.includeMarks?(this.includeMarks=!1,this.flagStates.splice(this.flagStates.length-1,1)):(this.includeMarks=!0,this.flagStates.push("question")),this.numFlagStates=this.flagStates.length},numToRowCol:function(e){return[Math.ceil(e/this.numCols),e%this.numCols||this.numCols]},rowColToNum:function(e,i){return(e-1)*this.numRows+i},start:function(){this.gameInProgress=!0,this.setTimer(1),this.runTimer()},stop:function(){this.stopTimer(),this.gameInProgress=!1;for(var e=1;e<=this.numRows;e++)for(var i=1;i<=this.numCols;i++)this.cells[e][i].$elem.unbind("click mouseup mousedown")},reset:function(){this.newGame(null,null,null,null,!0)},setTimer:function(e,i){var s=(i=i||!1)?this.$mineCountOnes:this.$timerOnes,t=i?this.$mineCountTens:this.$timerTens,n=i?this.$mineCountHundreds:this.$timerHundreds,l=Math.abs(e%10),o=Math.abs(e/10%10|0),a=e<0?"m":e/100%10|0;i?this.mineCount=e:this.timer=e,s.attr("class","t"+l),t.attr("class","t"+o),n.attr("class","t"+a)},setMineCount:function(e){this.setTimer(e,!0)},runTimer:function(){var e=this;this.stopTimerID=setTimeout(function(){if(e.gameInProgress){if(e.timer>998)return void e.lose();e.setTimer(++e.timer),e.runTimer()}},1e3)},stopTimer:function(){clearTimeout(this.stopTimerID)},lose:function(){this.stop(),this.revealMines(),this.$resetButton.attr("class","face-sad")},checkForWin:function(){for(var e=0,i=1;i<=this.numRows;i++)for(var s=1;s<=this.numCols;s++)this.cells[i][s].covered||e++;return e===this.numCells-this.numMines},win:function(){this.won=!0,this.stop(),this.flagMines(),this.$resetButton.attr("class","face-sunglasses"),this.setMineCount(0)},displayHighScoreDialog:function(){$("#submit-high-score").attr("disabled",!1),$("#high-score-dialog").show()},submitHighScore:function(){if(this.won)$("#high-score-name-textbox").val()},getHighScores:function(){}};$(document).ready(function(){minesweeper.init("game")});</script>
